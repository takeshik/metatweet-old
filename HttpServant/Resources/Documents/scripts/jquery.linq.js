// jquery.linq.js ver.2.0.0.0
jQuery.extend({Enumerable:function(){var o="undefined",m="Single:sequence contains more than one element.",e=true,l="function",i="string",k="boolean",h="number",b=null,a=false,d=function(a){this.GetEnumerator=a};d.Choice=function(){var a=arguments[0]instanceof Array?arguments[0]:arguments;return new d(function(){return new f(g.Blank,function(){return this.Yield(a[Math.floor(Math.random()*a.length)])},g.Blank)})};d.Cycle=function(){var a=arguments[0]instanceof Array?arguments[0]:arguments;return new d(function(){var b=0;return new f(g.Blank,function(){if(b>=a.length)b=0;return this.Yield(a[b++])},g.Blank)})};d.Empty=function(){return new d(function(){return new f(g.Blank,function(){return a},g.Blank)})};d.From=function(j){if(j==b)return d.Empty();if(j instanceof d)return j;if(typeof j==h||typeof j==k)return d.Repeat(j,1);if(typeof j==i)return new d(function(){var b=0;return new f(g.Blank,function(){return b<j.length?this.Yield(j.charAt(b++)):a},g.Blank)});if(typeof j!=l){if(typeof j.length==h)return new d(function(){var b=0;return new f(g.Blank,function(){while(b<j.length){if(!(j[b]instanceof Function))return this.Yield(j[b++]);b++}return a},g.Blank)});if(!(j instanceof Object)&&c.IsIEnumerable(j))return new d(function(){var c=e,b;return new f(function(){b=new Enumerator(j)},function(){if(c)c=a;else b.moveNext();return b.atEnd()?a:this.Yield(b.item())},g.Blank)})}return new d(function(){var b=[],c=0;return new f(function(){for(var a in j)!(j[a]instanceof Function)&&b.push({Key:a,Value:j[a]})},function(){return c<b.length?this.Yield(b[c++]):a},g.Blank)})},d.Return=function(a){return d.Repeat(a,1)};d.Matches=function(h,e,c){if(c==b)c="";if(e instanceof RegExp){c+=e.ignoreCase?"i":"";c+=e.multiline?"m":"";e=e.source}if(c.indexOf("g")===-1)c+="g";return new d(function(){var b;return new f(function(){b=new RegExp(e,c)},function(){var c=b.exec(h);return c?this.Yield(c):a},g.Blank)})};d.Range=function(e,c,a){if(a==b)a=1;return d.ToInfinity(e,a).Take(c)};d.RangeDown=function(e,c,a){if(a==b)a=1;return d.ToNegativeInfinity(e,a).Take(c)};d.RangeTo=function(c,e,a){if(a==b)a=1;return c<e?d.ToInfinity(c,a).TakeWhile(function(a){return a<=e}):d.ToNegativeInfinity(c,a).TakeWhile(function(a){return a>=e})};d.Repeat=function(c,a){if(a!=b)return d.Repeat(c).Take(a);return new d(function(){return new f(g.Blank,function(){return this.Yield(c)},g.Blank)})};d.RepeatWithFinalize=function(a,e){a=c.CreateLambda(a);e=c.CreateLambda(e);return new d(function(){var c;return new f(function(){c=a()},function(){return this.Yield(c)},function(){if(c!=b){e(c);c=b}})})};d.Generate=function(a,e){if(e!=b)return d.Generate(a).Take(e);a=c.CreateLambda(a);return new d(function(){return new f(g.Blank,function(){return this.Yield(a())},g.Blank)})};d.ToInfinity=function(c,a){if(c==b)c=0;if(a==b)a=1;return new d(function(){var b;return new f(function(){b=c-a},function(){return this.Yield(b+=a)},g.Blank)})};d.ToNegativeInfinity=function(c,a){if(c==b)c=0;if(a==b)a=1;return new d(function(){var b;return new f(function(){b=c+a},function(){return this.Yield(b-=a)},g.Blank)})};d.Unfold=function(h,b){b=c.CreateLambda(b);return new d(function(){var d=e,c;return new f(g.Blank,function(){if(d){d=a;c=h;return this.Yield(c)}c=b(c);return this.Yield(c)},g.Blank)})};d.prototype={CascadeBreadthFirst:function(g,b){var h=this;g=c.CreateLambda(g);b=c.CreateLambda(b);return new d(function(){var i,k=0,j=[];return new f(function(){i=h.GetEnumerator()},function(){while(e){if(i.MoveNext()){j.push(i.Current());return this.Yield(b(i.Current(),k))}var f=d.From(j).SelectMany(function(a){return g(a)});if(!f.Any())return a;else{k++;j=[];c.Dispose(i);i=f.GetEnumerator()}}},function(){c.Dispose(i)})})},CascadeDepthFirst:function(g,b){var h=this;g=c.CreateLambda(g);b=c.CreateLambda(b);return new d(function(){var j=[],i;return new f(function(){i=h.GetEnumerator()},function(){while(e){if(i.MoveNext()){var f=b(i.Current(),j.length);j.push(i);i=d.From(g(i.Current())).GetEnumerator();return this.Yield(f)}if(j.length<=0)return a;c.Dispose(i);i=j.pop()}},function(){try{c.Dispose(i)}finally{d.From(j).ForEach(function(a){a.Dispose()})}})})},Flatten:function(){var h=this;return new d(function(){var j,i=b;return new f(function(){j=h.GetEnumerator()},function(){while(e){if(i!=b)if(i.MoveNext())return this.Yield(i.Current());else i=b;if(j.MoveNext())if(j.Current()instanceof Array){c.Dispose(i);i=d.From(j.Current()).SelectMany(g.Identity).Flatten().GetEnumerator();continue}else return this.Yield(j.Current());return a}},function(){try{c.Dispose(j)}finally{c.Dispose(i)}})})},Pairwise:function(b){var e=this;b=c.CreateLambda(b);return new d(function(){var d;return new f(function(){d=e.GetEnumerator();d.MoveNext()},function(){var c=d.Current();return d.MoveNext()?this.Yield(b(c,d.Current())):a},function(){c.Dispose(d)})})},Scan:function(g,e,h){if(h!=b)return this.Scan(g,e).Select(h);if(e==b){e=c.CreateLambda(g);g=undefined}else e=c.CreateLambda(e);var i=this;return new d(function(){var b,d;return new f(function(){b=i.GetEnumerator()},function(){if(d===undefined)if(g===undefined){if(b.MoveNext())return this.Yield(d=b.Current())}else return this.Yield(d=g);return b.MoveNext()?this.Yield(d=e(d,b.Current())):a},function(){c.Dispose(b)})})},Select:function(b){var e=this;b=c.CreateLambda(b);return new d(function(){var d,g=0;return new f(function(){d=e.GetEnumerator()},function(){return d.MoveNext()?this.Yield(b(d.Current(),g++)):a},function(){c.Dispose(d)})})},SelectMany:function(g,e){var h=this;g=c.CreateLambda(g);if(e==b)e=function(b,a){return a};e=c.CreateLambda(e);return new d(function(){var j,i=undefined,k=0;return new f(function(){j=h.GetEnumerator()},function(){if(i===undefined)if(!j.MoveNext())return a;do{if(i==b){var f=g(j.Current(),k++);i=d.From(f).GetEnumerator()}if(i.MoveNext())return this.Yield(e(j.Current(),i.Current()));c.Dispose(i);i=b}while(j.MoveNext());return a},function(){try{c.Dispose(j)}finally{c.Dispose(i)}})})},Where:function(b){b=c.CreateLambda(b);var e=this;return new d(function(){var d,g=0;return new f(function(){d=e.GetEnumerator()},function(){while(d.MoveNext())if(b(d.Current(),g++))return this.Yield(d.Current());return a},function(){c.Dispose(d)})})},OfType:function(c){var a;switch(c){case Number:a=h;break;case String:a=i;break;case Boolean:a=k;break;case Function:a=l;break;default:a=b}return a===b?this.Where(function(a){return a instanceof c}):this.Where(function(b){return typeof b===a})},Zip:function(e,b){b=c.CreateLambda(b);var g=this;return new d(function(){var i,h,j=0;return new f(function(){i=g.GetEnumerator();h=d.From(e).GetEnumerator()},function(){if(i.MoveNext()&&h.MoveNext())return this.Yield(b(i.Current(),h.Current(),j++));return a},function(){try{c.Dispose(i)}finally{c.Dispose(h)}})})},Join:function(j,g,b,h){g=c.CreateLambda(g);b=c.CreateLambda(b);h=c.CreateLambda(h);var i=this;return new d(function(){var k,m,l=e,n=0;return new f(function(){k=i.GetEnumerator();m=d.From(j).ToLookup(b)},function(){while(e)if(!l||k.MoveNext()){var c=g(k.Current());if(m.hasOwnProperty(c)){var b=m[c][n++];if(b!==undefined){l=a;return this.Yield(h(k.Current(),b))}}l=e;n=0}else return a},function(){c.Dispose(k)})})},GroupJoin:function(j,g,e,h){g=c.CreateLambda(g);e=c.CreateLambda(e);h=c.CreateLambda(h);var i=this;return new d(function(){var k=i.GetEnumerator(),l=b;return new f(function(){k=i.GetEnumerator();l=d.From(j).ToLookup(e)},function(){if(k.MoveNext()){var b=d.From(l[g(k.Current())]);return this.Yield(h(k.Current(),b))}return a},function(){c.Dispose(k)})})},All:function(b){b=c.CreateLambda(b);var d=e;this.ForEach(function(c){if(!b(c)){d=a;return a}});return d},Any:function(d){d=c.CreateLambda(d);var b=this.GetEnumerator();try{if(arguments.length==0)return b.MoveNext();while(b.MoveNext())if(d(b.Current()))return e;return a}finally{c.Dispose(b)}},Concat:function(e){var g=this;return new d(function(){var i,h;return new f(function(){i=g.GetEnumerator()},function(){if(h==b){if(i.MoveNext())return this.Yield(i.Current());h=d.From(e).GetEnumerator()}if(h.MoveNext())return this.Yield(h.Current());return a},function(){try{c.Dispose(i)}finally{c.Dispose(h)}})})},Insert:function(h,b){var g=this;return new d(function(){var j,i,l=0,k=a;return new f(function(){j=g.GetEnumerator();i=d.From(b).GetEnumerator()},function(){if(l==h&&i.MoveNext()){k=e;return this.Yield(i.Current())}if(j.MoveNext()){l++;return this.Yield(j.Current())}if(!k&&i.MoveNext())return this.Yield(i.Current());return a},function(){try{c.Dispose(j)}finally{c.Dispose(i)}})})},Alternate:function(a){a=d.Return(a);return this.SelectMany(function(b){return d.Return(b).Concat(a)}).TakeExceptLast()},Contains:function(f,b){b=c.CreateLambda(b);var d=this.GetEnumerator();try{while(d.MoveNext())if(b(d.Current())===f)return e;return a}finally{c.Dispose(d)}},DefaultIfEmpty:function(b){var g=this;return new d(function(){var d,h=e;return new f(function(){d=g.GetEnumerator()},function(){if(d.MoveNext()){h=a;return this.Yield(d.Current())}else if(h){h=a;return this.Yield(b)}return a},function(){c.Dispose(d)})})},Distinct:function(a){return this.Except(d.Empty(),a)},Except:function(e,b){b=c.CreateLambda(b);var g=this;return new d(function(){var d,h;return new f(function(){d=g.GetEnumerator();h=(new n(b)).AddRange(e)},function(){while(d.MoveNext()){var b=d.Current();if(!h.Contains(b)){h.Add(b);return this.Yield(b)}}return a},function(){c.Dispose(d)})})},Intersect:function(e,b){b=c.CreateLambda(b);var g=this;return new d(function(){var d,i,h;return new f(function(){d=g.GetEnumerator();i=(new n(b)).AddRange(e);h=new n(b)},function(){while(d.MoveNext()){var b=d.Current();if(!h.Contains(b)&&i.Contains(b)){h.Add(b);return this.Yield(b)}}return a},function(){c.Dispose(d)})})},SequenceEqual:function(h,f){f=c.CreateLambda(f);var g=this.GetEnumerator();try{var b=d.From(h).GetEnumerator();try{while(g.MoveNext())if(!b.MoveNext()||f(g.Current())!==f(b.Current()))return a;if(b.MoveNext())return a;return e}finally{c.Dispose(b)}}finally{c.Dispose(g)}},Union:function(e,b){b=c.CreateLambda(b);var g=this;return new d(function(){var j,h,i;return new f(function(){j=g.GetEnumerator();i=new n(b)},function(){var b;if(h===undefined){while(j.MoveNext()){b=j.Current();if(!i.Contains(b)){i.Add(b);return this.Yield(b)}}h=d.From(e).GetEnumerator()}while(h.MoveNext()){b=h.Current();if(!i.Contains(b)){i.Add(b);return this.Yield(b)}}return a},function(){try{c.Dispose(j)}finally{c.Dispose(h)}})})},OrderBy:function(b){b=c.CreateLambda(b);return p(this,b,a)},OrderByDescending:function(a){a=c.CreateLambda(a);return p(this,a,e)},ThenBy:function(b){b=c.CreateLambda(b);return q(this,b,a)},ThenByDescending:function(a){a=c.CreateLambda(a);return q(this,a,e)},Reverse:function(){var b=this;return new d(function(){var c,d;return new f(function(){c=b.ToArray();d=c.length},function(){return d>0?this.Yield(c[--d]):a},g.Blank)})},Shuffle:function(){var b=this;return new d(function(){var c;return new f(function(){c=b.ToArray()},function(){if(c.length>0){var b=Math.floor(Math.random()*c.length);return this.Yield(c.splice(b,1)[0])}return a},g.Blank)})},GroupBy:function(h,g,e){var i=this;h=c.CreateLambda(h);g=c.CreateLambda(g);e=e==b?function(b,a){return {Key:b,Value:d.From(a)}}:c.CreateLambda(e);return new d(function(){var b;return new f(function(){b=d.From(i.ToLookup(h,g)).GetEnumerator()},function(){while(b.MoveNext())return this.Yield(e(b.Current().Key,d.From(b.Current().Value)));return a},function(){c.Dispose(b)})})},PartitionBy:function(h,g,i){var j=this;h=c.CreateLambda(h);g=c.CreateLambda(g);i=i==b?function(b,a){return {Key:b,Value:a}}:c.CreateLambda(i);return new d(function(){var b,l,k=[];return new f(function(){b=j.GetEnumerator();if(b.MoveNext()){l=h(b.Current());k.push(g(b.Current()))}},function(){var c;while((c=b.MoveNext())==e)if(l===h(b.Current()))k.push(g(b.Current()));else break;if(k.length>0){var f=i(l,d.From(k));if(c){l=h(b.Current());k=[g(b.Current())]}else k=[];return this.Yield(f)}return a},function(){c.Dispose(b)})})},BufferWithCount:function(e){var b=this;return new d(function(){var d;return new f(function(){d=b.GetEnumerator()},function(){var b=[],c=0;while(d.MoveNext()){b.push(d.Current());if(++c>=e)return this.Yield(b)}if(b.length>0)return this.Yield(b);return a},function(){c.Dispose(d)})})},Aggregate:function(c,b,a){return this.Scan(c,b,a).Last()},Average:function(a){a=c.CreateLambda(a);var d=0,b=0;this.ForEach(function(c){d+=a(c);++b});return d/b},Count:function(a){a=a==b?g.True:c.CreateLambda(a);var d=0;this.ForEach(function(c,b){if(a(c,b))++d});return d},Max:function(a){if(a==b)a=g.Identity;return this.Select(a).Aggregate(function(a,b){return a>b?a:b})},Min:function(a){if(a==b)a=g.Identity;return this.Select(a).Aggregate(function(a,b){return a<b?a:b})},MaxBy:function(a){a=c.CreateLambda(a);return this.Aggregate(function(b,c){return a(b)>a(c)?b:c})},MinBy:function(a){a=c.CreateLambda(a);return this.Aggregate(function(b,c){return a(b)<a(c)?b:c})},Sum:function(a){if(a==b)a=g.Identity;return this.Select(a).Aggregate(function(a,b){return a+b})},ElementAt:function(c){var b=undefined;this.ForEach(function(e,d){if(d==c){b=e;return a}});if(b===undefined)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return b},ElementAtOrDefault:function(d,c){var b=undefined;this.ForEach(function(e,c){if(c==d){b=e;return a}});return b===undefined?c:b},First:function(d){if(d!=b)return this.Where(d).First();var c=undefined;this.ForEach(function(b){c=b;return a});if(c===undefined)throw new Error("First:No element satisfies the condition.");return c},FirstOrDefault:function(d,e){if(e!=b)return this.Where(e).FirstOrDefault(d);var c=undefined;this.ForEach(function(b){c=b;return a});return c===undefined?d:c},Last:function(c){if(c!=b)return this.Where(c).Last();var a=undefined;this.ForEach(function(b){a=b});if(a===undefined)throw new Error("Last:No element satisfies the condition.");return a},LastOrDefault:function(c,d){if(d!=b)return this.Where(d).LastOrDefault(c);var a=undefined;this.ForEach(function(b){a=b});return a===undefined?c:a},Single:function(c){if(c!=b)return this.Where(c).Single();var a=undefined;this.ForEach(function(b){if(a===undefined)a=b;else throw new Error(m)});if(a===undefined)throw new Error("Single:No element satisfies the condition.");return a},SingleOrDefault:function(c,d){if(d!=b)return this.Where(d).SingleOrDefault(c);var a=undefined;this.ForEach(function(b){if(a===undefined)a=b;else throw new Error(m)});return a===undefined?c:a},Skip:function(e){var b=this;return new d(function(){var d,g=0;return new f(function(){d=b.GetEnumerator();while(g++<e&&d.MoveNext());},function(){return d.MoveNext()?this.Yield(d.Current()):a},function(){c.Dispose(d)})})},SkipWhile:function(b){b=c.CreateLambda(b);var g=this;return new d(function(){var d,i=0,h=a;return new f(function(){d=g.GetEnumerator()},function(){while(!h)if(d.MoveNext()){if(!b(d.Current(),i++)){h=e;return this.Yield(d.Current())}continue}else return a;return d.MoveNext()?this.Yield(d.Current()):a},function(){c.Dispose(d)})})},Take:function(e){var b=this;return new d(function(){var d,g=0;return new f(function(){d=b.GetEnumerator()},function(){return g++<e&&d.MoveNext()?this.Yield(d.Current()):a},function(){c.Dispose(d)})})},TakeWhile:function(b){b=c.CreateLambda(b);var e=this;return new d(function(){var d,g=0;return new f(function(){d=e.GetEnumerator()},function(){return d.MoveNext()&&b(d.Current(),g++)?this.Yield(d.Current()):a},function(){c.Dispose(d)})})},TakeExceptLast:function(e){if(e==b)e=1;var g=this;return new d(function(){if(e==0)return g.GetEnumerator();var b,d=[];return new f(function(){b=g.GetEnumerator()},function(){while(b.MoveNext()){if(d.length==e){d.push(b.Current());return this.Yield(d.shift())}d.push(b.Current())}return a},function(){c.Dispose(b)})})},IndexOf:function(c){var a=b;this.ForEach(function(d,b){if(d===c){a=b;return e}});return a!==b?a:-1},LastIndexOf:function(b){var a=-1;this.ForEach(function(d,c){if(d===b)a=c});return a},ToArray:function(){var a=[];this.ForEach(function(b){a.push(b)});return a},ToLookup:function(d,b){d=c.CreateLambda(d);b=c.CreateLambda(b);var a={};this.ForEach(function(f){var c=d(f),e=b(f);if(a.hasOwnProperty(c))a[c].push(e);else a[c]=[e]});return a},ToObject:function(b,a){b=c.CreateLambda(b);a=c.CreateLambda(a);var d={};this.ForEach(function(c){d[b(c)]=a(c)});return d},ToString:function(a,c){if(a==b)a="";if(c==b)c=g.Identity;return this.Select(c).ToArray().join(a)},Do:function(b){var e=this;b=c.CreateLambda(b);return new d(function(){var d,g=0;return new f(function(){d=e.GetEnumerator()},function(){if(d.MoveNext()){b(d.Current(),g++);return this.Yield(d.Current())}return a},function(){c.Dispose(d)})})},ForEach:function(d){d=c.CreateLambda(d);var e=0,b=this.GetEnumerator();try{while(b.MoveNext())if(d(b.Current(),e++)===a)break}finally{c.Dispose(b)}},Write:function(d,f){if(d==b)d="";f=c.CreateLambda(f);var g=e;this.ForEach(function(b){if(g)g=a;else document.write(d);document.write(f(b))})},WriteLine:function(a){a=c.CreateLambda(a);this.ForEach(function(b){document.write(a(b));document.write("<br />")})},Force:function(){var a=this.GetEnumerator();try{while(a.MoveNext());}finally{c.Dispose(a)}},Catch:function(b){b=c.CreateLambda(b);var e=this;return new d(function(){var d;return new f(function(){d=e.GetEnumerator()},function(){try{return d.MoveNext()?this.Yield(d.Current()):a}catch(c){b(c);return a}},function(){c.Dispose(d)})})},Finally:function(b){b=c.CreateLambda(b);var e=this;return new d(function(){var d;return new f(function(){d=e.GetEnumerator()},function(){return d.MoveNext()?this.Yield(d.Current()):a},function(){try{c.Dispose(d)}finally{b()}})})},Trace:function(d,a){if(d==b)d="Trace";a=c.CreateLambda(a);return this.Do(function(b){console.log(d,":",a(b))})}};var j={Before:0,Running:1,After:2},f=function(d,f,g){var c=new r,b=j.Before;this.Current=c.Current;this.MoveNext=function(){try{switch(b){case j.Before:b=j.Running;d();case j.Running:if(f.apply(c))return e;else{this.Dispose();return a}case j.After:return a}}catch(g){this.Dispose();throw g}};this.Dispose=function(){if(b==j.After)return;try{g()}finally{b=j.After}}},r=function(){var a=b;this.Current=function(){return a};this.Yield=function(b){a=b;return e}},g={Identity:function(a){return a},True:function(){return e},Blank:function(){}},c={CreateLambda:function(a){if(a==b)return g.Identity;if(typeof a==i)if(a=="")return g.Identity;else if(a.indexOf("=>")==-1)return new Function("$","return "+a);else{var c=a.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);return new Function(c[1],"return "+c[2])}return a},IsIEnumerable:function(b){if(typeof Enumerator!=o)try{new Enumerator(b);return e}catch(c){}return a},Compare:function(a,b){return a===b?0:a>b?1:-1},Dispose:function(a){a!=b&&a.Dispose()}},n=function(a){this.PrimitiveContainer={};this.ObjectContainer=[];this.CompareSelector=a==b?g.Identity:a};n.prototype={IsPrimitive:function(a){switch(typeof a){case i:case k:case h:case o:return e;case "object":case l:return a==b}},Add:function(c){var a=this;c=a.CompareSelector(c);if(a.IsPrimitive(c))a.PrimitiveContainer[c]=b;else a.ObjectContainer.push(c);return a},AddRange:function(a){var b=this;d.From(a).ForEach(function(a){b.Add(a)});return this},Contains:function(c){var b=this;c=b.CompareSelector(c);if(b.IsPrimitive(c))return b.PrimitiveContainer.hasOwnProperty(c);else{for(var d=0;d<b.ObjectContainer.length;d++)if(b.CompareSelector(c)===b.ObjectContainer[d])return e;return a}}};var p=function(h,g,e){return new d(function(i){var j;return new f(function(){i!=b&&i.reverse();var a=h.Select(function(a){return {key:g(a),value:a}}).ToArray().sort(function(g,h){var a=c.Compare(g.key,h.key);if(e)a=-a;if(a==0&&i!=b)for(var d=0;d<i.length;++d){var f=i[d].selector;a=c.Compare(f(g.value),f(h.value));if(i[d].isDescending)a=-a;if(a!=0)break}return a});j=d.From(a).Select(function(a){return a.value}).GetEnumerator()},function(){return j.MoveNext()?this.Yield(j.Current()):a},function(){c.Dispose(j)})})},q=function(h,g,e){return new d(function(i){var d;if(i==b)i=[];return new f(function(){i.push({selector:g,isDescending:e});d=h.GetEnumerator(i)},function(){return d.MoveNext()?this.Yield(d.Current()):a},function(){c.Dispose(d)})})};return d}()});(function(a){a.fn.toEnumerable=function(){return a.Enumerable.From(this).Select(function(b){return a(b)})};a.Enumerable.prototype.TojQuery=function(){return a(this.ToArray())}})(jQuery)